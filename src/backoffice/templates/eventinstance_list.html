{% extends 'base.html' %}
{% load commonmark %}
{% load static %}
{% load bornhack %}

{% block content %}
<div class="panel panel-default">
  <div class="panel-heading">
    <span class="h3">BackOffice - Scheduling EventInstances</span>
  </div>
  <div class="panel-body">
      <p><i>EventInstances</i> define the scheduling of <i>Events</i> at <i>EventLocations</i>. Search for an Event, Speaker, EventType, EventLocation, or day to filter the list.</p>
  {% if not eventinstance_list %}
      <p class="lead">
        No EventInstances found. Go create schedule something!
        <a href="{% url 'backoffice:eventinstancecreate_eventselect' camp_slug=camp.slug %}" class="btn btn-success"><i class="fas fa-plus"></i> Schedule Event</a>
      </p>
  {% else %}
  <p>
    <a href="{% url 'backoffice:eventinstancecreate_eventselect' camp_slug=camp.slug %}" class="btn btn-success"><i class="fas fa-plus"></i> Schedule Event</a>
    <a class="btn btn-default" href="{% url 'backoffice:index' camp_slug=camp.slug %}"><i class="fas fa-undo"></i> Backoffice</a>
  </p>
  <table class="table table-hover datatable">
    <thead>
    <tr>
        <th>Event</th>
        <th>People</th>
        <th>Event Type</th>
        <th>Location</th>
        <th>Overflow</th>
        <th>Start</th>
        <th>End</th>
        <th>Scheduled</th>
        <th>Actions</th>
     </tr>
    </thead>
    <tbody>
    {% for instance in eventinstance_list %}
    <tr>
        <td><a href="{% url 'backoffice:event_detail' camp_slug=camp.slug slug=instance.event.slug %}">{{ instance.event.title }}</a></td>
      <td>
        {% if instance.event.speakers.exists %}
        <ul class="list-group">
        {% for speaker in instance.event.speakers.all %}
          <li class="list-group-item"><i class="fas fa-user"></i> {{ speaker.name }}</li>
        {% endfor %}
        {% else %}
        N/A
        {% endif %}
        </ul>
      <td><i class="fas fa-{{ instance.event.event_type.icon }}" style="color: {{ instance.event.event_type.color }};"></i> {{ instance.event.event_type }}</td>
      <td><i class="fas fa-{{ instance.location.icon }}"></i> {{ instance.location.name }}</td>
      <td class="text-center {% if instance.overflow %}danger{% endif %}"><span class="badge">{{ instance.overflow }}</span></td>
      <td>{{ instance.when.lower }}</td>
      <td>{{ instance.when.upper }}</td>
      <td>{% if instance.autoscheduled %}Auto{% else %}Manual{% endif %}</td>
      <td>
        <div class="btn-group-vertical">
          <a href="{% url 'backoffice:eventinstance_detail' camp_slug=camp.slug pk=instance.id %}" class="btn btn-primary"><i class="fas fa-search"></i> Details</a>
          <a href="{% url 'backoffice:eventinstance_delete' camp_slug=camp.slug pk=instance.id %}" class="btn btn-danger"><i class="fas fa-times"></i> Delete</a>
        </div>
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
  {% endif %}
  <p>
    <a class="btn btn-success" href="{% url 'backoffice:eventinstancecreate_eventselect' camp_slug=camp.slug %}"><i class="fas fa-plus"></i> Schedule Event</a>
    <a class="btn btn-default" href="{% url 'backoffice:index' camp_slug=camp.slug %}"><i class="fas fa-undo"></i> Backoffice</a>
  </p>
  </div>
</div>
{% endblock content %}
